# Portfolio â€” Astro + Tailwind + Directus

A content-driven portfolio site built with Astro 5, Tailwind CSS v4, and Directus as a headless CMS. It features dynamic routing, a block-based page builder, Barba.js page transitions, GSAP animations, and a type-safe Directus SDK integration.

## Quick start

```sh
# Install deps (uses bun by default, but npm/pnpm/yarn work too)
bun install

# Start dev server
bun run dev

# Build for production
bun run build

# Preview production build
bun run preview
```

## Tech stack

- Astro 5 (islands, file-based routing)
- Tailwind CSS v4 + @tailwindcss/typography
- Directus SDK (REST) for content
- GSAP + ScrollTrigger + ScrollSmoother
- Barba.js (+ prefetch) for page transitions
- TypeScript

## Configuration

- Astro config: `astro.config.mjs` (Tailwind via Vite plugin)
- Tailwind styles and tokens: `src/styles/global.css`
- Component aliases and shadcn/ui config: `components.json`
- Type utilities: `src/lib/tw.ts`

## Environment

The Directus API base URL is currently defined in `src/types/env.ts`:

```ts
export const apiUrl: string = "https://judahsullivan.directus.app/";
```

If you need to point to another Directus instance, update that value or refactor to read from an environment variable.

## Scripts

- `bun run dev`: Start Astro dev server
- `bun run build`: Build static site
- `bun run preview`: Preview the production build

## Project structure

```
src/
  components/
    blocks/              # Block components (hero, posts, projects, etc.)
    builders/            # Map blocks to components, page/post/project builders
    globals/             # Head, navigation, footer
    ui/                  # UI primitives (buttons, images, cards)
  directus/
    cli.ts               # Directus client (REST)
    queries/             # Content queries (pages, posts, projects, globals)
  layouts/
    Layout/              # Root layout + Barba hooks
    Section.astro        # Section wrapper component
  lib/
    tw.ts                # clsx + tailwind-merge helper
  pages/
    [...path].astro      # Dynamic routing for pages, posts, projects
  scripts/
    initAnimations.ts    # GSAP + Barba setup and module loading
  styles/
    global.css           # Tailwind base, theme tokens, fonts
  types/
    directusCollection.ts# Generated/hand-authored Directus types
    env.ts               # API URL
```

## Content model (Directus)

Typed interfaces live in `src/types/directusCollection.ts`. Key collections:

- Pages: `pages` with `blocks` (array of polymorphic block references) and `permalink`
- Posts: `posts` with `slug`, `status`, `seo`
- Projects: `projects` with `slug`, `status`, `published_At`
- Navigation: `navigation` with nested `items` supporting pages and external links

Queries:

- Pages: `src/directus/queries/page.ts` (includes nested `blocks`)
- Posts: `src/directus/queries/articles.ts`
- Projects: `src/directus/queries/project.ts`
- Navigation: `src/directus/queries/globals.ts`

## Block-based page builder

- Builder: `src/components/builders/BlockBuilder.astro`
- Maps Directus `page_blocks.collection` to a component using a registry:
  - `block_hero`, `block_form`, `block_richtext`, `block_gallery`, `block_pricing`, `block_description`, `block_posts`, `block_collection`, `block_timeline`, `block_heading`, `block_list`, `block_projects`
- Add a new block:
  1) Create the block component under `src/components/blocks/<BlockName>/<BlockName>.astro`
  2) Update the `blockMap` in `BlockBuilder.astro`
  3) Ensure the Directus type exists in `directusCollection.ts`

## Routing

`src/pages/[...path].astro` implements dynamic routing:

- Pages render at `page.permalink`
- Posts render at `/post/<slug>`
- Projects render at `/project/<slug>`

Static paths are generated by fetching all pages, posts, and projects from Directus.

## Transitions and animations

- GSAP ScrollSmoother initializes in `src/scripts/initAnimations.ts`
- Barba.js is initialized and prefetch is enabled
- Per-scope transition modules are auto-imported from:
  - `src/components/blocks/*/*.barba.ts`
  - `src/layouts/*/*.barba.ts`
- Layout overlay transition is defined in `src/layouts/Layout/Layout.barba.ts` and wired via `<script src="./Layout.barba.ts">` in `Layout.astro`

## Styling

- Global theme tokens and Tailwind layers are in `src/styles/global.css`
- Fonts via `@fontsource/aileron` and `@fontsource/geist-sans`
- Utility `tw()` merges class names with `tailwind-merge`

## Development notes

- The project uses absolute import aliases (e.g. `@/components`, `@/directus`). See `components.json`.
- Client-side scripts are referenced in Astro components using relative `.ts` script tags (e.g. `Head.astro`, `Layout.astro`).
- Ensure your Directus instance exposes the required collections and fields per the types.

## License

MIT
