---
import Button from "@/components/ui/Button.astro";
import Section from "@/layouts/Section.astro";
import type { BlockButton, BlockDescription } from "@/types/directusCollection";

const props = Astro.props as BlockDescription;
const { tagline, headline, description, button_group } = props;

const buttons: BlockButton[] =
  typeof button_group === "object" && Array.isArray(button_group?.buttons)
    ? (button_group.buttons as BlockButton[] )
    : [];
---

<Section
  id="block-description"
  fullWidth
  class={`
    flex flex-col items-center justify-center
    gap-12 px-6 py-24 md:py-52 text-pretty
    md:flex-row md:gap-24 md:justify-between
  `}
>
  <div class="grid grid-cols-1 lg:grid-cols-3 md:gap-12">
    <!-- Left column: tagline + headline -->
    <div class="flex flex-col col-span-2 gap-4">
      {tagline && (
        <p class="desc-tagline text-sm text-gray-500 uppercase tracking-wide">
          {tagline}
        </p>
      )}
      {headline && (
        <h4 class="desc-title text-3xl lg:text-5xl leading-normal font-semibold text-gray-900 w-full">
          {headline}
        </h4>
      )}
    </div>

    <!-- Right column: description + button -->
    <div class="flex flex-col mt-6 md:mt-12 h-full justify-center text-pretty items-center text-left gap-6">
      {description && (
        <p class="desc-text text-sm md:text-base max-w-sm md:max-w-lg text-gray-700 text-pretty leading-relaxed">
          {description}
        </p>
      )}

      {buttons.length > 0 && (
        <div class="flex flex-wrap justify-end md:justify-center w-full">
          {buttons.map((btn, i) => {
            const href =
              btn.page && typeof btn.page !== "string"
                ? `/pages/${btn.page.permalink ?? btn.page.id}`
                : btn.post && typeof btn.post !== "string"
                ? `/posts/${btn.post.slug ?? btn.post.id}`
                : btn.url ?? "#";
            return (
              <a href={href} id={`${i}-${btn.id}`} class="overflow-hidden">
                <Button className="desc-btn translate-full transition-all opacity-0">{btn.label ?? "Click"}</Button>
              </a>
            );
          })}
        </div>
      )}
    </div>
  </div>

  <script src="./BlockDescription.barba.ts"></script>
</Section>

